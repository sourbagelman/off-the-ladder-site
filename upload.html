<!doctype html>
<html lang="en">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Upload Photos – Off The Ladder</title>
<style>
  :root{--primary:#5e2ca5}
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;margin:2rem;background:#f7f7fb}
  .card{max-width:620px;margin:auto;background:#fff;padding:1.25rem 1.25rem 1.75rem;border:1px solid #eee;border-radius:14px;box-shadow:0 2px 12px rgba(0,0,0,.04)}
  h2{margin:.25rem 0 1rem;color:#32155f}
  .muted{color:#666;font-size:.95rem;margin:.25rem 0 1rem}
  input,button{font:inherit}
  .btn{background:var(--primary);color:#fff;border:0;border-radius:10px;padding:.8rem 1rem;cursor:pointer}
  .btn:disabled{opacity:.6;cursor:not-allowed}
  #status{margin-top:1rem;white-space:pre-line}
  .row{display:flex;gap:.75rem;align-items:center;flex-wrap:wrap}
</style>

<div class="card">
  <h2>Upload photos</h2>
  <p class="muted">Choose images and they’ll appear on the gallery in seconds.</p>

  <div class="row">
    <input id="file" type="file" accept="image/*" multiple>
    <button class="btn" id="go">Upload</button>
  </div>

  <p class="muted" style="margin-top:.5rem">
    Tip: you can select multiple photos at once. HEIC/HEIF from iPhone is fine.
  </p>

  <div id="status"></div>
</div>

<script>
  // Your Cloudinary details
  const CLOUD_NAME = "dttivrbf0";
  const UPLOAD_PRESET = "otl-uploads";   // unsigned preset you created
  const FOLDER = "otl-gallery";          // make sure your preset saves to this folder

  const input = document.getElementById('file');
  const go = document.getElementById('go');
  const status = document.getElementById('status');

  const uploadOne = (file) => {
    const form = new FormData();
    form.append('file', file);
    form.append('upload_preset', UPLOAD_PRESET);
    form.append('folder', FOLDER);
    // optional tags if you ever want to filter by tag:
    form.append('tags', 'otl-gallery');

    return fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`, {
      method: 'POST',
      body: form
    }).then(r => r.json());
  };

  go.onclick = async () => {
    const files = [...(input.files||[])];
    if (!files.length) { status.textContent = "Pick at least one photo."; return; }

    go.disabled = true;
    status.textContent = `Uploading ${files.length} file(s)…`;

    let ok = 0, fail = 0;
    for (const f of files) {
      try {
        const res = await uploadOne(f);
        if (res.secure_url) ok++; else fail++;
      } catch { fail++; }
      status.textContent = `Uploading… ${ok} done, ${fail} failed.`;
    }

    status.textContent = `Done. ${ok} uploaded, ${fail} failed.\nOpen the gallery page and refresh.`;
    go.disabled = false;
    input.value = '';
  };
</script>
</html>
